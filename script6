local player = game.Players.LocalPlayer
local gui = Instance.new("ScreenGui")
gui.Name = "LuxuryUI"
gui.ResetOnSpawn = false
gui.Parent = player:WaitForChild("PlayerGui")

-- Frame اصلی GUI
local frame = Instance.new("Frame")
frame.Size = UDim2.new(0, 180, 0, 360)
frame.Position = UDim2.new(0.5, -90, 0.5, -180)
frame.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
frame.BackgroundTransparency = 0.25
frame.BorderSizePixel = 0
frame.Parent = gui

local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(0, 14)
corner.Parent = frame

-- Drag Bar برای حرکت دادن GUI
local dragBar = Instance.new("Frame")
dragBar.Size = UDim2.new(1, 0, 0, 32)
dragBar.BackgroundTransparency = 0.2
dragBar.BackgroundColor3 = Color3.fromRGB(200, 0, 0)
dragBar.Parent = frame

local dragCorner = Instance.new("UICorner")
dragCorner.CornerRadius = UDim.new(0, 14)
dragCorner.Parent = dragBar

-- عنوان GUI
local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, -32, 1, 0)
title.BackgroundTransparency = 1
title.Text = "پنل دنس 666"
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.Font = Enum.Font.GothamBold
title.TextSize = 14
title.TextXAlignment = Enum.TextXAlignment.Left
title.Parent = dragBar

-- Collapse/Expand button
local toggleBtn = Instance.new("TextButton")
toggleBtn.Size = UDim2.new(0, 24, 0, 24)
toggleBtn.Position = UDim2.new(1, -28, 0, 4)
toggleBtn.BackgroundColor3 = Color3.fromRGB(255, 50, 50)
toggleBtn.BackgroundTransparency = 0.1
toggleBtn.Text = "▲"
toggleBtn.Font = Enum.Font.GothamBold
toggleBtn.TextSize = 14
toggleBtn.TextColor3 = Color3.fromRGB(255,255,255)
toggleBtn.BorderSizePixel = 0
toggleBtn.Parent = dragBar

local crnToggle = Instance.new("UICorner")
crnToggle.CornerRadius = UDim.new(0, 6)
crnToggle.Parent = toggleBtn

-- Drag system
local UIS = game:GetService("UserInputService")
local dragging = false
local dragStart, startPos

local function update(input)
    local delta = input.Position - dragStart
    frame.Position = UDim2.new(
        startPos.X.Scale, startPos.X.Offset + delta.X,
        startPos.Y.Scale, startPos.Y.Offset + delta.Y
    )
end

dragBar.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1
    or input.UserInputType == Enum.UserInputType.Touch then
        dragging = true
        dragStart = input.Position
        startPos = frame.Position
    end
end)

dragBar.InputChanged:Connect(function(input)
    if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement
    or input.UserInputType == Enum.UserInputType.Touch) then
        update(input)
    end
end)

UIS.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1
    or input.UserInputType == Enum.UserInputType.Touch then
        dragging = false
    end
end)

-- ScrollFrame برای دکمه‌ها
local scroll = Instance.new("ScrollingFrame")
scroll.Size = UDim2.new(1, -14, 1, -40)
scroll.Position = UDim2.new(0, 7, 0, 35)
scroll.ScrollBarThickness = 5
scroll.BackgroundTransparency = 1
scroll.Parent = frame

local layout = Instance.new("UIListLayout")
layout.Padding = UDim.new(0, 4)
layout.Parent = scroll

local buttonHeight = 28

-- جدول Toggle دکمه‌ها
local toggles = {}
local animationTracks = {}

-- تضمین وجود Humanoid
local function getHumanoidSafe()
    local char = player.Character or player.CharacterAdded:Wait()
    local hum = char:FindFirstChildOfClass("Humanoid")
    while not hum do
        task.wait()
        char = player.Character or player.CharacterAdded:Wait()
        hum = char:FindFirstChildOfClass("Humanoid")
    end
    return hum
end

-- تابع ساخت دکمه‌ها با Toggle و انیمیشن
local function createToggleButton(name, animationId, speed)
    toggles[name] = false

    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(1, -6, 0, buttonHeight)
    btn.BackgroundColor3 = Color3.fromRGB(170, 0, 0)
    btn.BackgroundTransparency = 0.2
    btn.Text = name.." | خاموش"
    btn.TextColor3 = Color3.fromRGB(255, 255, 255)
    btn.Font = Enum.Font.GothamBold
    btn.TextSize = 14
    btn.BorderSizePixel = 0
    btn.Parent = scroll

    local crn = Instance.new("UICorner")
    crn.CornerRadius = UDim.new(0, 8)
    crn.Parent = btn

    btn.MouseButton1Click:Connect(function()
        toggles[name] = not toggles[name]

        if toggles[name] then
            btn.Text = name.." | روشن"
            btn.BackgroundColor3 = Color3.fromRGB(255, 80, 80)
        else
            btn.Text = name.." | خاموش"
            btn.BackgroundColor3 = Color3.fromRGB(170, 0, 0)
        end

        local humanoid = getHumanoidSafe()

        -- اگر Track قبلی وجود دارد، متوقفش کن
        if animationTracks[name] then
            animationTracks[name]:Stop()
        end

        -- یک Track جدید بساز و اگر دکمه روشن است، اجرا کن
        local anim = Instance.new("Animation")
        anim.AnimationId = animationId
        local track = humanoid:LoadAnimation(anim)
        track.Looped = true
        animationTracks[name] = track

        if toggles[name] then
            track:Play()
            track:AdjustSpeed(speed)
        end
    end)
end

-- پیکربندی دکمه‌ها: نام، AnimationId و سرعت
local buttonConfigs = {
    {Name="رقص", AnimId="rbxassetid://75202452138001", Speed=1.6},
    {Name="هکر", AnimId="rbxassetid://33796059", Speed=99},
    {Name="چرخش", AnimId="rbxassetid://188632011", Speed=2},
    {Name="هکر 2", AnimId="rbxassetid://215384594", Speed=22},
    {Name="MoonDance", AnimId="rbxassetid://27789359", Speed=1.1},
    {Name="Charleston Dance", AnimId="rbxassetid://429703734", Speed=1.1},
    {Name="شناور", AnimId="rbxassetid://313762630", Speed=1},
    {Name="بدون نام", AnimId="rbxassetid://148840371", Speed=14},
    {Name="راه رفتن", AnimId="rbxassetid://180426354", Speed=1},
}

-- افزایش CanvasSize ScrollFrame
scroll.CanvasSize = UDim2.new(0,0,0,#buttonConfigs*(buttonHeight+4))

-- ساخت دکمه‌ها
for _, config in ipairs(buttonConfigs) do
    createToggleButton(config.Name, config.AnimId, config.Speed)
end

-- Collapse / Expand GUI
local collapsed = false
toggleBtn.MouseButton1Click:Connect(function()
    if collapsed then
        scroll.Visible = true
        frame.Size = UDim2.new(0, 180, 0, 360)
        toggleBtn.Text = "▲"
        collapsed = false
    else
        scroll.Visible = false
        frame.Size = UDim2.new(0, 180, 0, 40)
        toggleBtn.Text = "▼"
        collapsed = true
    end
end)
